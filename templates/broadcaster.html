<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TgNinja - Рассылка по чатам</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/dark-theme.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
    <style>
        /* Additional styles specific to the broadcaster page */
        .broadcaster-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 20px;
        }
        
        .broadcaster-section {
            background-color: var(--bg-white);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .stats-counters {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .stats-counter {
            background-color: var(--bg-white);
            border-radius: var(--border-radius);
            padding: 15px;
            flex: 1;
            margin: 0 10px;
            text-align: center;
            box-shadow: var(--shadow-sm);
        }
        
        .stats-counter:first-child {
            margin-left: 0;
        }
        
        .stats-counter:last-child {
            margin-right: 0;
        }
        
        .counter-value {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .counter-label {
            font-size: 14px;
            color: var(--text-light);
        }
        
        .tasks-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .tasks-table th, 
        .tasks-table td {
            text-align: left;
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .tasks-table th {
            font-weight: 500;
            color: var(--text-light);
            background-color: #f9fafc;
        }
        
        .tasks-table tbody tr {
            transition: var(--transition);
        }
        
        .tasks-table tbody tr:hover {
            background-color: rgba(0, 0, 0, 0.01);
        }
        
        .task-info {
            display: flex;
            flex-direction: column;
        }
        
        .task-name {
            font-weight: 500;
        }
        
        .task-details {
            color: var(--text-light);
            font-size: 13px;
        }
        
        .task-progress {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
        }
        
        .empty-tasks {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
        }
        
        .empty-tasks i {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.4;
        }
        
        /* Custom styles for selection items */
        .selection-item {
            padding: 10px;
            border-radius: var(--border-radius);
            margin-bottom: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        
        .selection-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .selection-item.selected {
            background-color: rgba(62, 142, 208, 0.1);
        }
        
        .selection-item-info {
            flex: 1;
            margin-left: 10px;
        }
        
        .selection-item-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f0f0f0;
        }
        
        .selection-item-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .selection-item-name {
            font-weight: 500;
        }
        
        .selection-item-details {
            font-size: 12px;
            color: var(--text-light);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <svg class="logo" viewBox="0 0 24 24">
                    <use xlink:href="#logo"></use>
                </svg>
                <h1>TgNinja</h1>
            </div>
            
            <nav class="sidebar-nav">
                <ul id="sidebar-menu">
                    <li data-page="accounts">
                        <i class="fas fa-users"></i>
                        <span>Аккаунты</span>
                    </li>
                    <li data-page="proxies">
                        <i class="fas fa-shield-alt"></i>
                        <span>Прокси</span>
                    </li>
                    <li data-page="parser">
                        <i class="fas fa-search"></i>
                        <span>Парсер групп</span>
                    </li>
                    <li class="active" data-page="broadcaster">
                        <i class="fas fa-broadcast-tower"></i>
                        <span>Рассылка</span>
                    </li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <button id="settings-btn" class="btn btn-icon">
                    <i class="fas fa-cog"></i>
                </button>
                <button id="theme-toggle-btn" class="theme-toggle btn btn-icon" title="Toggle dark mode">
                    <i class="fas fa-sun light-icon"></i>
                    <i class="fas fa-moon dark-icon"></i>
                </button>
                <button id="help-btn" class="btn btn-icon">
                    <i class="fas fa-question-circle"></i>
                </button>
            </div>
        </aside>
        
        <main class="main-content">
            <header class="main-header">
                <div class="header-left">
                    <h2>Рассылка по чатам</h2>
                    <div class="stats-container">
                        <div class="stat-item">
                            <i class="fas fa-broadcast-tower"></i>
                            <span>Отправка сообщений в чаты</span>
                        </div>
                    </div>
                </div>
                
                <div class="header-right">
                    <div class="actions-container">
                        <button id="refresh-tasks-btn" class="btn btn-secondary">
                            <i class="fas fa-sync-alt"></i> Обновить
                        </button>
                        <button id="new-task-btn" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Новая задача
                        </button>
                    </div>
                </div>
            </header>
            
            <section class="accounts-section">
                <div class="broadcaster-container">
                    <!-- Statistics Counters -->
                    <div class="stats-counters">
                        <div class="stats-counter">
                            <div class="counter-value" id="today-counter">0</div>
                            <div class="counter-label">Сделано сегодня</div>
                        </div>
                        <div class="stats-counter">
                            <div class="counter-value" id="yesterday-counter">0</div>
                            <div class="counter-label">Сделано вчера</div>
                        </div>
                        <div class="stats-counter">
                            <div class="counter-value" id="total-counter">0</div>
                            <div class="counter-label">Сделано всего</div>
                        </div>
                    </div>
                    
                    <!-- Task List Section -->
                    <div class="broadcaster-section">
                        <div class="section-header" style="margin-bottom: 15px;">
                            <h3>Задачи рассылки</h3>
                        </div>
                        
                        <div class="table-container">
                            <table class="tasks-table">
                                <thead>
                                    <tr>
                                        <th>НАЗВАНИЕ ЗАДАЧИ</th>
                                        <th>СТАТУС</th>
                                        <th>СОЗДАНА</th>
                                        <th>СЕГОДНЯ/ВСЕГО</th>
                                        <th>ДЕЙСТВИЯ</th>
                                    </tr>
                                </thead>
                                <tbody id="task-list-container">
                                    <!-- Tasks will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div id="empty-tasks-message" class="empty-tasks">
                            <i class="fas fa-broadcast-tower"></i>
                            <h3>Нет активных задач</h3>
                            <p>Создайте новую задачу рассылки</p>
                            <button class="btn btn-primary" id="empty-add-task-btn">
                                <i class="fas fa-plus"></i> Новая задача
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <!-- Modal Container -->
    <div class="modal-container" id="modal-container">
        <!-- Enhanced Broadcaster Modal -->
        <div class="modal" id="enhanced-broadcaster-modal">
            <div class="modal-header">
                <h3>Enhanced Broadcaster</h3>
                <button class="btn-close" data-close-modal="enhanced-broadcaster-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Task Name -->
                <div class="form-group mb-4">
                    <label for="taskName">Название задачи</label>
                    <div class="relative">
                        <input 
                            id="taskName"
                            type="text" 
                            class="form-control"
                            value="My task"
                        >
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3">
                            <i class="fas fa-info-circle text-gray-400"></i>
                        </div>
                    </div>
                </div>
        
                <!-- File Upload -->
                <div class="form-group mb-4">
                    <label>Укажите txt-файл со ссылками на чаты и/или парсы с чатами. По одной ссылке в строке.</label>
                    <div class="flex items-center mt-2">
                        <label class="btn btn-secondary">
                            <i class="fas fa-upload mr-2"></i>
                            <span class="text-base leading-normal">Choose file</span>
                            <input type='file' id="chat-links-file" class="hidden">
                        </label>
                        <span class="ml-3 text-gray-500" id="selected-file-name">
                            No file chosen
                        </span>
                    </div>
                </div>
        
                <!-- Message Type -->
                <div class="form-group mb-4">
                    <div class="flex flex-col space-y-2">
                        <label class="inline-flex items-center">
                            <input 
                                type="radio" 
                                name="sendMode" 
                                value="single"
                                checked
                            >
                            <span class="ml-2">Отправлять одно сообщение</span>
                        </label>
                        
                        <div class="ml-7" id="single-message-container">
                            <textarea
                                id="enhanced-message-text"
                                class="form-control"
                                rows="4"
                                placeholder="Enter your message"
                            >[Здравствуйте]/[Добрый день]/[Доброго времени суток]. Увидел вас в чате...</textarea>
                            <div class="flex justify-end mt-2">
                                <button 
                                    type="button" 
                                    class="btn btn-text btn-sm"
                                    id="add-document-btn"
                                >
                                    Добавить к сообщению документ или картинку (до 1МБ)
                                </button>
                            </div>
                        </div>
                        
                        <label class="inline-flex items-center">
                            <input 
                                type="radio" 
                                name="sendMode" 
                                value="file"
                            >
                            <span class="ml-2">Отправлять сообщения из txt-файла (разделитель сообщений - "Test")</span>
                        </label>
                        
                        <label class="inline-flex items-center">
                            <input 
                                type="radio" 
                                name="sendMode" 
                                value="repost"
                            >
                            <span class="ml-2">Отправлять репосты из ПУБЛИЧНОГО чата или канала с РАЗРЕШЁННЫМИ репостами (по одной ссылке в строке)</span>
                        </label>
                    </div>
                </div>
        
                <!-- Work Mode -->
                <div class="form-group mb-4">
                    <label>Режим работы:</label>
                    <div class="flex flex-col space-y-2 mt-2">
                        <label class="inline-flex items-center">
                            <input 
                                type="radio" 
                                name="workMode" 
                                value="group"
                                checked
                            >
                            <span class="ml-2">Постинг в группу чатов</span>
                        </label>
                        
                        <div class="ml-7" id="group-chat-container">
                            <div class="flex items-center">
                                <span class="mr-2">Количество чатов, в которые рассылает один аккаунт:</span>
                                <input 
                                    type="number" 
                                    id="chatCount"
                                    min="1" 
                                    max="30"
                                    class="form-control w-16"
                                    value="6"
                                >
                            </div>
                            <div class="text-xs text-gray-500 mt-1">
                                Не рекомендуем для данной настройки выставлять значение больше "30"
                            </div>
                        </div>
                        
                        <label class="inline-flex items-center">
                            <input 
                                type="radio" 
                                name="workMode" 
                                value="single"
                            >
                            <span class="ml-2">Постинг в один чат</span>
                        </label>
                    </div>
                </div>
        
                <!-- Additional Options -->
                <div class="form-group mb-4">
                    <div class="flex flex-col space-y-2">
                        <label class="inline-flex items-center">
                            <input 
                                type="checkbox" 
                                id="joinChats"
                            >
                            <span class="ml-2">Начинать постинг не дожидаясь вступления во все чаты</span>
                        </label>
                        
                        <label class="inline-flex items-center">
                            <input 
                                type="checkbox" 
                                id="repeatBroadcast"
                            >
                            <span class="ml-2">Повторить рассылку после отправки одного сообщения во все чаты</span>
                        </label>
                        
                        <div class="flex items-center ml-7 mt-2" id="repeat-interval-container" style="display: none;">
                            <span class="mr-2">Пауза перед следующей отправкой от:</span>
                            <input 
                                type="number" 
                                id="waitMin"
                                min="1" 
                                class="form-control w-16"
                                value="1"
                            >
                            <span class="mx-2">до:</span>
                            <input 
                                type="number" 
                                id="waitMax"
                                min="1" 
                                class="form-control w-16"
                                value="1"
                            >
                            <span class="ml-2">мин.</span>
                        </div>
                    </div>
                </div>
        
                <!-- Account Selection -->
                <div class="form-group mb-6 border-t pt-4">
                    <label class="block mb-2">
                        Аккаунты, от имени которых будут отправлены сообщения:
                    </label>
                    <div id="account-selector" class="bg-blue-500 text-white text-center py-3 rounded cursor-pointer hover:bg-blue-600 mb-4">
                        Выбрать аккаунты
                    </div>
                    
                    <div id="selected-accounts-container" class="grid grid-cols-2 gap-4">
                        <!-- Selected accounts will be displayed here -->
                    </div>
                </div>
        
                <!-- Additional Settings -->
                <div class="form-group mb-6">
                    <div class="flex flex-col space-y-2">
                        <label class="inline-flex items-center">
                            <input 
                                type="checkbox" 
                                id="hideSource"
                            >
                            <span class="ml-2">Скрывать источник пересылки</span>
                        </label>
                        
                        <label class="inline-flex items-center">
                            <input 
                                type="checkbox" 
                                id="processAfterPost"
                            >
                            <span class="ml-2">После размещения поста проверять не удален ли он (снижает скорость работы задачи)</span>
                        </label>
                        
                        <label class="inline-flex items-center">
                            <input 
                                type="checkbox" 
                                id="deleteAfter"
                            >
                            <span class="ml-2">Удалять отправленные посты через:</span>
                        </label>
                        
                        <label class="inline-flex items-center">
                            <input 
                                type="checkbox" 
                                id="leaveChats"
                            >
                            <span class="ml-2">Аккаунтам выйти из всех чатов</span>
                        </label>
                        
                        <label class="inline-flex items-center">
                            <input 
                                type="checkbox" 
                                id="useFloodCheck"
                            >
                            <span class="ml-2">В случае PEER_FLOOD_ERROR вместо отметки проверять через @spambot (только для премиума)</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="/js/broadcaster.js"></script>
    <script src="/js/theme-toggle.js"></script>
    <script src="/js/sidebar-navigation.js"></script>
</body>
</html>